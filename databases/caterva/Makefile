# Created by: Po-Chuan Hsieh <sunpoet@FreeBSD.org>

PORTNAME=	caterva
PORTVERSION=	0.5.0
DISTVERSIONPREFIX=	v
CATEGORIES=	databases

MAINTAINER=	sunpoet@FreeBSD.org
COMMENT=	Multidimensional data container on top of Blosc2

LICENSE=	BSD3CLAUSE
LICENSE_FILE=	${WRKSRC}/LICENSE

LIB_DEPENDS=	libblosc2.so:archivers/c-blosc2

USES=		cmake pkgconfig

CMAKE_OFF=	CATERVA_ENABLE_ASAN CATERVA_ENABLE_COVERAGE
CMAKE_ON=	CATERVA_BUILD_BENCH CATERVA_BUILD_EXAMPLES CATERVA_BUILD_TESTS CATERVA_PREFER_BLOSC2_EXTERNAL CATERVA_SHARED_LIB CATERVA_STATIC_LIB
USE_LDCONFIG=	yes

PLIST_SUB=	PORTVERSION=${PORTVERSION}

GH_ACCOUNT=	Blosc
USE_GITHUB=	yes

post-patch:
	@${REINPLACE_CMD} -e 's|%%PORTVERSION%%|${PORTVERSION}|' ${WRKSRC}/CMakeLists.txt

do-test:
	cd ${TEST_WRKSRC} && ctest

.include <bsd.port.mk>
